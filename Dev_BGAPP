pipeline {
    agent {
        label 'win-Devagent'
    }

    environment {
        CI = 'false'
    }

    stages {
        stage('Checkout') {
            steps {
                git branch: 'dev', credentialsId: 'aee5f756-7752-47bb-ba93-9ba15b199308', url: 'http://172.30.1.200:3005/IfinixFintech_BankGuarantee/BankGuarantee.git'
            }
        }

        stage('Install Dependencies') {
            options {
                timeout(time: 60, unit: 'MINUTES')
            }
            steps {
                withEnv(["PATH+NODE=C:\\Program Files\\nodejs"]) {
                    bat 'npm install'
                }
            }
        }

        stage('Build') {
            steps {
                withEnv(["PATH+NODE=C:\\Program Files\\nodejs"]) {
                    bat 'npm run build'
                }
            }
        }

        // stage('Test') {
        //     steps {
        //         withEnv(["PATH+NODE=C:\\Program Files\\nodejs"]) {
        //             bat 'npm test'
        //         }
        //     }
        // }

        stage('Deploy') {
            steps {
                // Use /Y to suppress confirmation prompts
                bat 'xcopy /E /I /Y build\\* C:\\BG\\BGAPP\\'
            }
        }
    }

      post {
    always {
        emailext(
            subject: "Build Notification: ${JOB_NAME} #${BUILD_NUMBER}",
            body: """
                The build is complete on Dev Enviornment.

                Pipeline Name: ${JOB_NAME}
                Build Number: ${BUILD_NUMBER}
                Status: ${currentBuild.currentResult}

                View details at: ${BUILD_URL}
            """,
           to: 'anup.dudhe@ifinixfintech.com,nikhil.vargude@ifinixfintech.com,sachin.suryawanshi@ifinixfintech.com,avinash.chirame@ifinixfintech.com,prathamesh.more@ifinixfintech.com,sahil.mulani@ifinixfintech.com,mayuri.bonde@ifinixfintech.com,sarika.kute@ifinixfintech.com,pooja.erulkar@ifinixfintech.com,aniket.randive@ifinixfintech.com,aniket.kamble@ifinixfintech.com,vrushali.tatke@ifinixfintech.com,shreyash.bongulwar@ifinixfintech.com,aarti.methe@ifinixfintech.com,ashvini.awathe@ifinixfintech.com,shital.rajemane@ifinixfintech.com,tejal.kangude@ifinixfintech.com,namrata.chavan@ifinixfintech.com,mahesh.suryawanshi@ifinixfintech.com,saurav.gaikwad@ifinixfintech.com,abhinav.kumar@ifinixfintech.com,tejal.kangude@ifinixfintech.com,prakash.bangar@ifinixfintech.com,gaurav.kadam@ifinixfintech.com,digvijay.patil@ifinixfintech.com,nikhil.mane@ifinixfintech.com,adesh.belokar@ifinixfintech.com,abhinav.kumar@ifinixfintech.com'
        )
    }
}
}
